<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.deepsoft.haolifa.dao.repository.extend.AutoControlMaterialExtendMapper">

    <select id="pageRecord" parameterType="com.deepsoft.haolifa.model.dto.autoControl.AutoControlEntryOutPage"
            resultType="com.deepsoft.haolifa.model.dto.autoControl.AutoControlEntryOutRecordRespVo">
        SELECT
          a.id,
          a.quantity,
          a.type,
          a.auto_control_id autoControlId,
          a.update_time updateTime,
          a.receive_department receiveDepartment,
          b.classify_name classifyName,
          b.graph_no graphNo,
          b.material_name materialName,
          b.model,
          b.specifications,
          b.price
        FROM
            `auto_control_entry_out_record` a
        INNER JOIN auto_control_material b ON a.auto_control_id = b.id
        WHERE 1=1
        <if test="autoControlId!= null and autoControlId>0">
            and a.auto_control_id = #{autoControlId}
        </if>
        <if test="type!= null">
            and a.type = #{type}
        </if>
        <if test="materialName != null and materialName !=''">
            and b.material_name like CONCAT('%',#{materialName},'%')
        </if>
        <if test="startDate != null and startDate !=''">
            and a.update_time &gt;= #{startDate}
        </if>
        <if test="endDate != null and endDate !=''">
            and a.update_time &lt;= #{endDate}
        </if>
        order by a.update_time desc
    </select>

</mapper>
