package com.deepsoft.haolifa.finance;

import com.alibaba.fastjson.JSON;
import com.deepsoft.haolifa.BaseTest;
import com.deepsoft.haolifa.dao.repository.*;
import com.deepsoft.haolifa.enums.DictEnum;
import com.deepsoft.haolifa.model.domain.BizCostBudgetSubjects;
import com.deepsoft.haolifa.model.domain.BizSubjects;
import com.deepsoft.haolifa.model.domain.BizSubjectsExample;
import com.deepsoft.haolifa.model.domain.SysDict;
import com.deepsoft.haolifa.model.dto.DepartmentDTO;
import com.deepsoft.haolifa.service.DepartmentService;
import com.deepsoft.haolifa.service.SysDictService;
import com.deepsoft.haolifa.service.SysUserService;
import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;

import java.math.BigDecimal;
import java.util.Date;
import java.util.List;
import java.util.Map;
import java.util.function.Function;
import java.util.stream.Collectors;

public class CostServiceTest extends BaseTest {

    @Autowired
    private BizCostBudgetDeptMapper bizCostBudgetDeptMapper;

    @Autowired
    private BizCostBudgetSubjectsMapper bizCostBudgetSubjectsMapper;

    @Autowired
    private SysDepartmentMapper departmentMapper;

    @Autowired
    private SysUserService sysUserService;

    @Autowired
    private DepartmentService departmentService;

    @Autowired
    private BizBillMapper bizBillMapper;

    @Autowired
    private BizOtherBillMapper bizOtherBillMapper;

    @Autowired
    private BizBankBillMapper bizBankBillMapper;

    @Autowired
    private SysDictService sysDictService;
    @Autowired
    private BizSubjectsMapper subjectsMapper;

    @Autowired
    private BizSubjectsBalanceMapper subjectsBalanceMapper;

    @Test
    public void t1() {

        String str  = "[{\"序号\":1,\"费用类别\":\"管理费用\",\"明细\":\"审计费\",\"编码\":\"0000115\",\"科目描述\":\"审计所出具审计报告费用\"},{\"序号\":2,\"费用类别\":\"财务费用\",\"明细\":\"办公费\",\"编码\":\"0000201\",\"科目描述\":\"书报费，印刷费，日常办公用品费，消耗用品费，年检，审计费，其他。\"},{\"序号\":3,\"费用类别\":\"财务费用\",\"明细\":\"差旅费\",\"编码\":\"0000202\",\"科目描述\":\"职工出差发生的费用\"},{\"序号\":4,\"费用类别\":\"财务费用\",\"明细\":\"软件费\",\"编码\":\"0000203\",\"科目描述\":\"购买软件的服务费\"},{\"序号\":5,\"费用类别\":\"财务费用\",\"明细\":\"交通费\",\"编码\":\"0000204\",\"科目描述\":\"管理部门市内办公发生的交通费，培训期间发生的市内交通费等\"},{\"序号\":6,\"费用类别\":\"财务费用\",\"明细\":\"贷款\",\"编码\":\"0000205\",\"科目描述\":\"银行贷款及其他筹资方式贷款\"},{\"序号\":7,\"费用类别\":\"财务费用\",\"明细\":\"手续费\",\"编码\":\"0000206\",\"科目描述\":\"在银行结算过程中支付的手续费，办理电汇所支付的手续费、邮电费，购买空白支票、电汇单、汇票等所支付的工本费、银行转账手续费、电子回单柜年费等。\"},{\"序号\":8,\"费用类别\":\"财务费用\",\"明细\":\"贷款利息\",\"编码\":\"0000207\",\"科目描述\":\"银行贷款利息支出及其他筹资方式下支付利息支出\"},{\"序号\":9,\"费用类别\":\"财务费用\",\"明细\":\"培训费\",\"编码\":\"0000208\"},{\"序号\":10,\"费用类别\":\"税金\",\"明细\":\"增值税\",\"编码\":\"0001301\"},{\"序号\":11,\"费用类别\":\"税金\",\"明细\":\"城市维护建设税\",\"编码\":\"0001302\"},{\"序号\":12,\"费用类别\":\"税金\",\"明细\":\"教育费附加\",\"编码\":\"0001303\"},{\"序号\":13,\"费用类别\":\"税金\",\"明细\":\"地方教育费附加\",\"编码\":\"0001304\"},{\"序号\":14,\"费用类别\":\"税金\",\"明细\":\"印花税\",\"编码\":\"0001305\"},{\"序号\":15,\"费用类别\":\"税金\",\"明细\":\"土地使用税\",\"编码\":\"0001306\"},{\"序号\":16,\"费用类别\":\"税金\",\"明细\":\"企业所得税\",\"编码\":\"0001307\"},{\"序号\":17,\"费用类别\":\"税金\",\"明细\":\"残疾人就业保障金\",\"编码\":\"0001308\"},{\"序号\":18,\"费用类别\":\"税金\",\"明细\":\"房产税\",\"编码\":\"0001309\"},{\"序号\":19,\"费用类别\":\"税金\",\"明细\":\"工会经费\",\"编码\":\"0001310\"},{\"序号\":20,\"费用类别\":\"工资\",\"明细\":\"财务管理中心\",\"编码\":\"0001504\"},{\"序号\":21,\"费用类别\":\"管理费用\",\"明细\":\"知识产权费\",\"编码\":\"0000105\",\"科目描述\":\"申请的知识产权费用\"},{\"序号\":22,\"费用类别\":\"研发费用\",\"明细\":\"差旅费\",\"编码\":\"0000601\",\"科目描述\":\"研究开发活动直接相关的其他费用\"},{\"序号\":23,\"费用类别\":\"研发费用\",\"明细\":\"培训费\",\"编码\":\"0000602\",\"科目描述\":\"研究开发活动直接相关的其他费用\"},{\"序号\":24,\"费用类别\":\"研发费用\",\"明细\":\"检测费\",\"编码\":\"0000603\",\"科目描述\":\"用于研究开发活动的仪器、设备的运行维护、调整、检验、检测、维修等费用\"},{\"序号\":25,\"费用类别\":\"研发费用\",\"明细\":\"材料费\",\"编码\":\"0000604\",\"科目描述\":\"直接消耗的材料、燃料和动力费用\"},{\"序号\":26,\"费用类别\":\"研发费用\",\"明细\":\"委托加工费\",\"编码\":\"0000605\",\"科目描述\":\"企业委托境内其他机构或个人进行研究开发活动所发生的费用\"},{\"序号\":27,\"费用类别\":\"研发费用\",\"明细\":\"设备费\",\"编码\":\"0000606\",\"科目描述\":\"用于研究开发活动投入的设备\"},{\"序号\":28,\"费用类别\":\"研发费用\",\"明细\":\"工装费\",\"编码\":\"0000607\",\"科目描述\":\"用于中间试验和产品试制的模具、工艺装备开发及制造费\"},{\"序号\":29,\"费用类别\":\"研发费用\",\"明细\":\"试验费\",\"编码\":\"0000608\",\"科目描述\":\"用于研究开发活动的仪器、设备的运行维护、调整、检验、检测、维修等费用\"},{\"序号\":30,\"费用类别\":\"研发费用\",\"明细\":\"模具\",\"编码\":\"0000609\",\"科目描述\":\"用于中间试验和产品试制的模具\"},{\"序号\":31,\"费用类别\":\"研发费用\",\"明细\":\"办公费\",\"编码\":\"0000610\"},{\"序号\":32,\"费用类别\":\"研发费用\",\"明细\":\"招待费\",\"编码\":\"0000611\"},{\"序号\":33,\"费用类别\":\"固定资产\",\"明细\":\"模具\",\"编码\":\"0001205\"},{\"序号\":34,\"费用类别\":\"工资\",\"明细\":\"产品研发中心\",\"编码\":\"0001505\"},{\"序号\":35,\"费用类别\":\"质量费用\",\"明细\":\"差旅费\",\"编码\":\"0000501\",\"科目描述\":\"职工出差发生的费用\"},{\"序号\":36,\"费用类别\":\"质量费用\",\"明细\":\"认证费\",\"编码\":\"0000502\"},{\"序号\":37,\"费用类别\":\"质量费用\",\"明细\":\"培训费\",\"编码\":\"0000503\",\"科目描述\":\"讲师费/资料费/餐费/其他\"},{\"序号\":38,\"费用类别\":\"质量费用\",\"明细\":\"检测费\",\"编码\":\"0000504\"},{\"序号\":39,\"费用类别\":\"质量费用\",\"明细\":\"运费\",\"编码\":\"0000505\",\"科目描述\":\"通过运输公司发生的运费\"},{\"序号\":40,\"费用类别\":\"质量费用\",\"明细\":\"办公费\",\"编码\":\"0000506\"},{\"序号\":41,\"费用类别\":\"质量费用\",\"明细\":\"招待费\",\"编码\":\"0000507\"},{\"序号\":42,\"费用类别\":\"质量费用\",\"明细\":\"售后运费\",\"编码\":\"0000114\",\"科目描述\":\"通过运输公司发生的售后运费，售后问题不归属于生产部分的费用\"},{\"序号\":43,\"费用类别\":\"质量费用\",\"明细\":\"售后费用\",\"编码\":\"0000115\",\"科目描述\":\"为履行合同约定的明确的售后条款内容应发生的一切费用，售后问题不归属于生产部分的费用\"},{\"序号\":44,\"费用类别\":\"工资\",\"明细\":\"技术质量管理中心\",\"编码\":\"0001503\"},{\"序号\":45,\"费用类别\":\"采购费用\",\"明细\":\"差旅费\",\"编码\":\"0000301\",\"科目描述\":\"职工出差发生的费用\"},{\"序号\":46,\"费用类别\":\"采购费用\",\"明细\":\"招待费\",\"编码\":\"0000302\",\"科目描述\":\"对外招待供应商发生的餐费及职工内部聚餐发生的费用\"},{\"序号\":47,\"费用类别\":\"采购费用\",\"明细\":\"办公费\",\"编码\":\"0000303\",\"科目描述\":\"书报费，印刷费，日常办公用品费，消耗用品费，其他。\"},{\"序号\":48,\"费用类别\":\"采购费用\",\"明细\":\"运费\",\"编码\":\"0000304\",\"科目描述\":\"采购材料通过运输公司发生的运费\"},{\"序号\":49,\"费用类别\":\"采购费用\",\"明细\":\"交通费\",\"编码\":\"0000305\",\"科目描述\":\"管理部门市内办公发生的交通费，培训期间发生的市内交通费等\"},{\"序号\":50,\"费用类别\":\"采购费用\",\"明细\":\"其它\",\"编码\":\"0000306\",\"科目描述\":\"与采购有关未列明的费用\"},{\"序号\":51,\"费用类别\":\"生产费用\",\"明细\":\"折旧费\",\"编码\":\"0000401\",\"科目描述\":\"生产车间使用的固定资产每月所计提的折旧。\"},{\"序号\":52,\"费用类别\":\"生产费用\",\"明细\":\"刀具\",\"编码\":\"0000402\",\"科目描述\":\"生产车间购买的低值易耗品\"},{\"序号\":53,\"费用类别\":\"生产费用\",\"明细\":\"夹具\",\"编码\":\"0000403\",\"科目描述\":\"生产车间购买的低值易耗品\"},{\"序号\":54,\"费用类别\":\"生产费用\",\"明细\":\"量具\",\"编码\":\"0000404\",\"科目描述\":\"生产车间购买的低值易耗品\"},{\"序号\":55,\"费用类别\":\"生产费用\",\"明细\":\"工具\",\"编码\":\"0000405\",\"科目描述\":\"生产车间购买的低值易耗品\"},{\"序号\":56,\"费用类别\":\"生产费用\",\"明细\":\"售后费用\",\"编码\":\"0000406\",\"科目描述\":\"为履行合同约定的明确的售后条款内容应发生的一切费用，售后问题不归属于生产部分的费用\"},{\"序号\":57,\"费用类别\":\"生产费用\",\"明细\":\"招待费\",\"编码\":\"0000407\",\"科目描述\":\"对外招待客户发生的餐费及职工内部聚餐发生的费用\"},{\"序号\":58,\"费用类别\":\"生产费用\",\"明细\":\"劳保费\",\"编码\":\"0000408\",\"科目描述\":\"公司为职工购买劳保用品所发生的费用\"},{\"序号\":59,\"费用类别\":\"生产费用\",\"明细\":\"维修费\",\"编码\":\"0000409\",\"科目描述\":\"生产线的日常修理费\"},{\"序号\":60,\"费用类别\":\"生产费用\",\"明细\":\"委托加工费\",\"编码\":\"0000410\",\"科目描述\":\"委托外单位加工的各种物资的实际成本\"},{\"序号\":61,\"费用类别\":\"销售费用\",\"明细\":\"差旅费\",\"编码\":\"0000801\",\"科目描述\":\"职工因工作外出期间发生的住宿费，交通费等，包括：交通车费、交通机票、住宿费、伙食补贴、其他相关的费用\"},{\"序号\":62,\"费用类别\":\"销售费用\",\"明细\":\"招待费\",\"编码\":\"0000802\",\"科目描述\":\"销售部门发生的与销售活动有关的业务招待费支出，具体包括：餐饮费、礼品费、其他相关的费用\"},{\"序号\":63,\"费用类别\":\"销售费用\",\"明细\":\"运费\",\"编码\":\"0000803\",\"科目描述\":\"为销售货物而发生的产品运输费用\"},{\"序号\":64,\"费用类别\":\"销售费用\",\"明细\":\"展会费\",\"编码\":\"0000805\",\"科目描述\":\"为开展促销或宣传产品等举办展览、展销会所支出的各项具有公共性质的费用，包括：资料费、礼品费、及其他相关的开支。\"},{\"序号\":65,\"费用类别\":\"销售费用\",\"明细\":\"办公费\",\"编码\":\"0000806\"},{\"序号\":66,\"费用类别\":\"固定资产\",\"明细\":\"机器\",\"编码\":\"0001203\"},{\"序号\":67,\"费用类别\":\"固定资产\",\"明细\":\"设备\",\"编码\":\"0001204\"},{\"序号\":68,\"费用类别\":\"固定资产\",\"明细\":\"器具\",\"编码\":\"0001207\"},{\"序号\":69,\"费用类别\":\"固定资产\",\"明细\":\"工具\",\"编码\":\"0001208\"},{\"序号\":70,\"费用类别\":\"材料费\",\"明细\":\"原材料\",\"编码\":\"0001401\"},{\"序号\":71,\"费用类别\":\"材料费\",\"明细\":\"辅助材料\",\"编码\":\"0001402\"},{\"序号\":72,\"费用类别\":\"材料费\",\"明细\":\"整机采购\",\"编码\":\"0001403\"},{\"序号\":73,\"费用类别\":\"工资\",\"明细\":\"经营管理中心\",\"编码\":\"0001502\"},{\"序号\":74,\"费用类别\":\"工资\",\"明细\":\"机加事业部\",\"编码\":\"0001506\"},{\"序号\":75,\"费用类别\":\"工资\",\"明细\":\"控制阀事业部\",\"编码\":\"0001507\"},{\"序号\":76,\"费用类别\":\"工资\",\"明细\":\"覆层事业部\",\"编码\":\"0001508\"},{\"序号\":77,\"费用类别\":\"工资\",\"明细\":\"装配事业部\",\"编码\":\"0001509\"},{\"序号\":78,\"费用类别\":\"工资\",\"明细\":\"橡胶事业部\",\"编码\":\"0001510\"},{\"序号\":79,\"费用类别\":\"工资\",\"明细\":\"生产部\",\"编码\":\"0001511\"},{\"序号\":80,\"费用类别\":\"管理费用\",\"明细\":\"差旅费\",\"编码\":\"0000101\",\"科目描述\":\"职工出差发生的费用\"},{\"序号\":81,\"费用类别\":\"管理费用\",\"明细\":\"招待费\",\"编码\":\"0000102\",\"科目描述\":\"对外招待客户发生的餐费及职工内部聚餐发生的费用\"},{\"序号\":82,\"费用类别\":\"管理费用\",\"明细\":\"通讯费\",\"编码\":\"0000103\",\"科目描述\":\"办公室有线电话使用费\"},{\"序号\":83,\"费用类别\":\"管理费用\",\"明细\":\"交通费\",\"编码\":\"0000104\",\"科目描述\":\"管理部门市内办公发生的交通费，培训期间发生的市内交通费等\"},{\"序号\":84,\"费用类别\":\"管理费用\",\"明细\":\"劳保费\",\"编码\":\"0000106\",\"科目描述\":\"公司为职工购买劳保用品所发生的费用\"},{\"序号\":85,\"费用类别\":\"管理费用\",\"明细\":\"办公费\",\"编码\":\"0000107\",\"科目描述\":\"书报费，印刷费，日常办公用品费，消耗用品费，年检，审计费，其他。\"},{\"序号\":86,\"费用类别\":\"管理费用\",\"明细\":\"修理费\",\"编码\":\"0000108\",\"科目描述\":\"包含电脑，空调，打印机，复印机等的修理安装费，硬件升级费，办公楼装修费，其他管理部办公用品移动和安装费等。\"},{\"序号\":87,\"费用类别\":\"管理费用\",\"明细\":\"职工福利费\",\"编码\":\"0000109\",\"科目描述\":\"包括医疗用品，公司组织职工体检费，工伤医疗费，工作人员租房费，餐厅用厨具，夜班补助，职工慰问金。\"},{\"序号\":88,\"费用类别\":\"管理费用\",\"明细\":\"折旧费\",\"编码\":\"0000110\",\"科目描述\":\"管理部使用的固定资产每月所计提的折旧。\"},{\"序号\":89,\"费用类别\":\"管理费用\",\"明细\":\"咨询服务费\",\"编码\":\"0000111\",\"科目描述\":\"包含公司聘请律师顾问费、会计税务咨询费及其他信息咨询费用\"},{\"序号\":90,\"费用类别\":\"管理费用\",\"明细\":\"物料消耗\",\"编码\":\"0000112\",\"科目描述\":\"购买硬盘、光盘、软盘等电脑用品，以及插座等维修零件\"},{\"序号\":91,\"费用类别\":\"管理费用\",\"明细\":\"礼品费\",\"编码\":\"0000113\",\"科目描述\":\"节日福利\"},{\"序号\":92,\"费用类别\":\"管理费用\",\"明细\":\"会议费\",\"编码\":\"0000114\",\"科目描述\":\"公司召开董事会发生的会议费\"},{\"序号\":93,\"费用类别\":\"管理费用\",\"明细\":\"培训费\",\"编码\":\"0000116\",\"科目描述\":\"讲师费/资料费/餐费/其他\"},{\"序号\":94,\"费用类别\":\"管理费用\",\"明细\":\"无形资产摊销\",\"编码\":\"0000117\",\"科目描述\":\"指月底对公司所拥有的无形资产分期摊销，结转费用\"},{\"序号\":95,\"费用类别\":\"管理费用\",\"明细\":\"其它\",\"编码\":\"0000118\",\"科目描述\":\"与管理有关未列明的费用\"},{\"序号\":96,\"费用类别\":\"管理费用\",\"明细\":\"专项福利费\",\"编码\":\"0000119\"},{\"序号\":97,\"费用类别\":\"管理费用\",\"明细\":\"领导费用\",\"编码\":\"0000120\"},{\"序号\":98,\"费用类别\":\"能耗费用\",\"明细\":\"生产电费\",\"编码\":\"0000701\",\"科目描述\":\"生产车间消耗电的费用\"},{\"序号\":99,\"费用类别\":\"能耗费用\",\"明细\":\"生产水费\",\"编码\":\"0000702\",\"科目描述\":\"生产车间消耗水的费用\"},{\"序号\":100,\"费用类别\":\"能耗费用\",\"明细\":\"办公电费\",\"编码\":\"0000703\",\"科目描述\":\"管理部门消耗电的费用\"},{\"序号\":101,\"费用类别\":\"能耗费用\",\"明细\":\"办公水费\",\"编码\":\"0000704\",\"科目描述\":\"管理部门消耗水的费用\"},{\"序号\":102,\"费用类别\":\"车辆费用\",\"明细\":\"油费\",\"编码\":\"0000901\",\"科目描述\":\"车辆使用汽油、机油的费用\"},{\"序号\":103,\"费用类别\":\"车辆费用\",\"明细\":\"年检费\",\"编码\":\"0000902\",\"科目描述\":\"车辆发生的年检费\"},{\"序号\":104,\"费用类别\":\"车辆费用\",\"明细\":\"保险费\",\"编码\":\"0000903\",\"科目描述\":\"包含公司投的车辆保险费等\"},{\"序号\":105,\"费用类别\":\"车辆费用\",\"明细\":\"维修费\",\"编码\":\"0000904\",\"科目描述\":\"车辆的修理维护费\"},{\"序号\":106,\"费用类别\":\"车辆费用\",\"明细\":\"过路费\",\"编码\":\"0000905\",\"科目描述\":\"使用的车辆按国家规定所交的公路过路费\"},{\"序号\":107,\"费用类别\":\"车辆费用\",\"明细\":\"租赁费\",\"编码\":\"0000906\",\"科目描述\":\"租用车辆发生的费用\"},{\"序号\":108,\"费用类别\":\"租金\",\"科目描述\":\"包括厂房租赁费，会议室租赁费，职工宿舍房租，其他的管理部门使用场地时发生的场地费用。\"},{\"序号\":109,\"费用类别\":\"社保\",\"明细\":\"养老保险\",\"编码\":\"0001101\",\"科目描述\":\"公司和个人按一定工资比例交纳的保险\"},{\"序号\":110,\"费用类别\":\"社保\",\"明细\":\"工伤保险\",\"编码\":\"0001102\",\"科目描述\":\"公司按一定工资比例交纳的保险\"},{\"序号\":111,\"费用类别\":\"社保\",\"明细\":\"医疗保险\",\"编码\":\"0001103\",\"科目描述\":\"公司和个人按一定工资比例交纳的保险\"},{\"序号\":112,\"费用类别\":\"社保\",\"明细\":\"失业保险\",\"编码\":\"0001104\",\"科目描述\":\"公司按一定工资比例交纳的保险\"},{\"序号\":113,\"费用类别\":\"固定资产\",\"明细\":\"房屋\",\"编码\":\"0001201\"},{\"序号\":114,\"费用类别\":\"固定资产\",\"明细\":\"建筑物\",\"编码\":\"0001202\"},{\"序号\":115,\"费用类别\":\"固定资产\",\"明细\":\"运输工具\",\"编码\":\"0001206\"},{\"序号\":116,\"费用类别\":\"固定资产\",\"明细\":\"家具\",\"编码\":\"0001209\"},{\"序号\":117,\"费用类别\":\"固定资产\",\"明细\":\"电子设备\",\"编码\":\"0001210\"},{\"序号\":118,\"费用类别\":\"工资\",\"明细\":\"行政管理中心\",\"编码\":\"0001501\"}]";

//        INSERT INTO `haolifa`.`biz_subjects`
//        (`id`, `name`, `type`, `parent_id`, `level`, `code`, `remark`, `status`, `del_flag`, `percent`, `create_user`, `create_time`, `update_user`, `update_time`)
//        VALUES
//        (17, '差旅费', '00001', 0, 0, '0000101', '职工出差发生的费用', '0', '0', 0, NULL, NULL, NULL, NULL);

        Map<String, String> dictMap = sysDictService.getSysDictByTypeCode(DictEnum.SUBJECTS_TYPE.getCode()).stream()
            .collect(Collectors.toMap(SysDict::getName, SysDict::getCode, (a, b) -> a));

        List<Map> parseArray = JSON.parseArray(str, Map.class);
        for (int i = 0; i < parseArray.size(); i++) {
            Map map = parseArray.get(i);
            Object mx = map.get("明细");
            if (mx == null){
                continue;
            }

            BizSubjects bizSubjects = new BizSubjects();
            bizSubjects.setId(Integer.parseInt(map.get("序号").toString()));
            bizSubjects.setName(map.get("明细").toString());
            String fylb = dictMap.get(map.get("费用类别").toString());
            bizSubjects.setType(fylb);
            bizSubjects.setCode(map.get("编码").toString());
            bizSubjects.setRemark(map.get("科目描述") == null ? null:map.get("科目描述").toString());
            int insertId = subjectsMapper.insertSelective(bizSubjects);
        }

    }

    @Test
    public void t2() {

        String str  = "[{\"序号\":1,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"审计费\",\"明细编码\":\"0000115\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.00177492},{\"序号\":2,\"费用类别\":\"财务费用\",\"类别编码\":\"00002\",\"明细\":\"办公费\",\"明细编码\":\"0000201\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":5.91638958242123E-4},{\"序号\":3,\"费用类别\":\"财务费用\",\"类别编码\":\"00002\",\"明细\":\"差旅费\",\"明细编码\":\"0000202\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":2.95819479121061E-4},{\"序号\":4,\"费用类别\":\"财务费用\",\"类别编码\":\"00002\",\"明细\":\"软件费\",\"明细编码\":\"0000203\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":2.95819479121061E-4},{\"序号\":5,\"费用类别\":\"财务费用\",\"类别编码\":\"00002\",\"明细\":\"交通费\",\"明细编码\":\"0000204\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":5.91638958242123E-5},{\"序号\":6,\"费用类别\":\"财务费用\",\"类别编码\":\"00002\",\"明细\":\"贷款\",\"明细编码\":\"0000205\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.657902521565241},{\"序号\":7,\"费用类别\":\"财务费用\",\"类别编码\":\"00002\",\"明细\":\"手续费\",\"明细编码\":\"0000206\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.00177491687472637},{\"序号\":8,\"费用类别\":\"财务费用\",\"类别编码\":\"00002\",\"明细\":\"贷款利息\",\"明细编码\":\"0000207\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.0502893114505802},{\"序号\":9,\"费用类别\":\"财务费用\",\"类别编码\":\"00002\",\"明细\":\"培训费\",\"明细编码\":\"0000208\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":5.91638958242123E-4},{\"序号\":10,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"增值税\",\"明细编码\":\"0001301\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.177491687472637},{\"序号\":11,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"城市维护建设税\",\"明细编码\":\"0001302\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.0124244181230846},{\"序号\":12,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"教育费附加\",\"明细编码\":\"0001303\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.00532475062417912},{\"序号\":13,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"地方教育费附加\",\"明细编码\":\"0001304\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.00354983374945273},{\"序号\":14,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"印花税\",\"明细编码\":\"0001305\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.00177491687472637},{\"序号\":15,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"土地使用税\",\"明细编码\":\"0001306\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.00473311166593697},{\"序号\":16,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"企业所得税\",\"明细编码\":\"0001307\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.0076913064571476},{\"序号\":17,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"残疾人就业保障金\",\"明细编码\":\"0001308\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.0076913064571476},{\"序号\":18,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"房产税\",\"明细编码\":\"0001309\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.0236655583296849},{\"序号\":19,\"费用类别\":\"税金\",\"类别编码\":\"00013\",\"明细\":\"工会经费\",\"明细编码\":\"0001310\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.00538391452000331},{\"序号\":20,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"财务管理中心\",\"明细编码\":\"0001504\",\"归属部门\":\"财务管理中心\",\"明细占部门预算比\":0.0366816154110116},{\"序号\":21,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"知识产权费\",\"明细编码\":\"0000105\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.0199362041467305},{\"序号\":22,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"差旅费\",\"明细编码\":\"0000601\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.0159489633173844},{\"序号\":23,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"培训费\",\"明细编码\":\"0000602\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.00854408749145592},{\"序号\":24,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"检测费\",\"明细编码\":\"0000603\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.0142401458190932},{\"序号\":25,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"材料费\",\"明细编码\":\"0000604\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.0341763499658236},{\"序号\":26,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"委托加工费\",\"明细编码\":\"0000605\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.00284802916381864},{\"序号\":27,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"设备费\",\"明细编码\":\"0000606\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.00854408749145592},{\"序号\":28,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"工装费\",\"明细编码\":\"0000607\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.00854408749145592},{\"序号\":29,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"试验费\",\"明细编码\":\"0000608\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.00284802916381864},{\"序号\":30,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"模具\",\"明细编码\":\"0000609\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.284802916381864},{\"序号\":31,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"办公费\",\"明细编码\":\"0000610\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.0142401458190932},{\"序号\":32,\"费用类别\":\"研发费用\",\"类别编码\":\"00006\",\"明细\":\"招待费\",\"明细编码\":\"0000611\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.00142401458190932},{\"序号\":33,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"模具\",\"明细编码\":\"0001205\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0},{\"序号\":34,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"产品研发中心\",\"明细编码\":\"0001505\",\"归属部门\":\"产品研发中心\",\"明细占部门预算比\":0.583845978582821},{\"序号\":35,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"差旅费\",\"明细编码\":\"0000501\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.0100532823967025},{\"序号\":36,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"认证费\",\"明细编码\":\"0000502\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.0552930531818639},{\"序号\":37,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"培训费\",\"明细编码\":\"0000503\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.0150799235950538},{\"序号\":38,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"检测费\",\"明细编码\":\"0000504\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.0201065647934051},{\"序号\":39,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"运费\",\"明细编码\":\"0000505\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.0150799235950538},{\"序号\":40,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"办公费\",\"明细编码\":\"0000506\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.0100532823967025},{\"序号\":41,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"招待费\",\"明细编码\":\"0000507\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.00502664119835126},{\"序号\":42,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"售后运费\",\"明细编码\":\"0000114\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.0201065647934051},{\"序号\":43,\"费用类别\":\"质量费用\",\"类别编码\":\"00005\",\"明细\":\"售后费用\",\"明细编码\":\"0000115\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.0150799235950538},{\"序号\":44,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"技术质量管理中心\",\"明细编码\":\"0001503\",\"归属部门\":\"技术质量管理中心\",\"明细占部门预算比\":0.834422438926312},{\"序号\":45,\"费用类别\":\"采购费用\",\"类别编码\":\"00003\",\"明细\":\"差旅费\",\"明细编码\":\"0000301\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":1.15127526761394E-4},{\"序号\":46,\"费用类别\":\"采购费用\",\"类别编码\":\"00003\",\"明细\":\"招待费\",\"明细编码\":\"0000302\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":1.15127526761394E-4},{\"序号\":47,\"费用类别\":\"采购费用\",\"类别编码\":\"00003\",\"明细\":\"办公费\",\"明细编码\":\"0000303\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":2.30255053522787E-5},{\"序号\":48,\"费用类别\":\"采购费用\",\"类别编码\":\"00003\",\"明细\":\"运费\",\"明细编码\":\"0000304\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0184204042818229},{\"序号\":49,\"费用类别\":\"采购费用\",\"类别编码\":\"00003\",\"明细\":\"交通费\",\"明细编码\":\"0000305\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":1.15127526761394E-4},{\"序号\":50,\"费用类别\":\"采购费用\",\"类别编码\":\"00003\",\"明细\":\"其它\",\"明细编码\":\"0000306\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":1.15127526761394E-4},{\"序号\":51,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"折旧费\",\"明细编码\":\"0000401\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0},{\"序号\":52,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"刀具\",\"明细编码\":\"0000402\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0034538258028418},{\"序号\":53,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"夹具\",\"明细编码\":\"0000403\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":9.21020214091148E-4},{\"序号\":54,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"量具\",\"明细编码\":\"0000404\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":5.75637633806968E-4},{\"序号\":55,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"工具\",\"明细编码\":\"0000405\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0034538258028418},{\"序号\":56,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"售后费用\",\"明细编码\":\"0000406\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":4.60510107045575E-4},{\"序号\":57,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"招待费\",\"明细编码\":\"0000407\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":2.30255053522787E-5},{\"序号\":58,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"劳保费\",\"明细编码\":\"0000408\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.00138153032113672},{\"序号\":59,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"维修费\",\"明细编码\":\"0000409\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.00230255053522787},{\"序号\":60,\"费用类别\":\"生产费用\",\"类别编码\":\"00004\",\"明细\":\"委托加工费\",\"明细编码\":\"0000410\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.00115127526761394},{\"序号\":61,\"费用类别\":\"销售费用\",\"类别编码\":\"00008\",\"明细\":\"差旅费\",\"明细编码\":\"0000801\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":2.30255053522787E-4},{\"序号\":62,\"费用类别\":\"销售费用\",\"类别编码\":\"00008\",\"明细\":\"招待费\",\"明细编码\":\"0000802\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":1.15127526761394E-4},{\"序号\":63,\"费用类别\":\"销售费用\",\"类别编码\":\"00008\",\"明细\":\"运费\",\"明细编码\":\"0000803\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0660832003610399},{\"序号\":64,\"费用类别\":\"销售费用\",\"类别编码\":\"00008\",\"明细\":\"展会费\",\"明细编码\":\"0000805\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.00690765160568362},{\"序号\":65,\"费用类别\":\"销售费用\",\"类别编码\":\"00008\",\"明细\":\"办公费\",\"明细编码\":\"0000806\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":1.15127526761394E-4},{\"序号\":66,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"机器\",\"明细编码\":\"0001203\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0},{\"序号\":67,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"设备\",\"明细编码\":\"0001204\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0034538258028418},{\"序号\":68,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"器具\",\"明细编码\":\"0001207\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0},{\"序号\":69,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"工具\",\"明细编码\":\"0001208\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.00115127526761394},{\"序号\":70,\"费用类别\":\"材料费\",\"类别编码\":\"00014\",\"明细\":\"原材料\",\"明细编码\":\"0001401\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.61415930426133},{\"序号\":71,\"费用类别\":\"材料费\",\"类别编码\":\"00014\",\"明细\":\"辅助材料\",\"明细编码\":\"0001402\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.103614774085254},{\"序号\":72,\"费用类别\":\"材料费\",\"类别编码\":\"00014\",\"明细\":\"整机采购\",\"明细编码\":\"0001403\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0138153032113672},{\"序号\":73,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"经营管理中心\",\"明细编码\":\"0001502\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0133547931043217},{\"序号\":74,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"机加事业部\",\"明细编码\":\"0001506\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0269398412621661},{\"序号\":75,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"控制阀事业部\",\"明细编码\":\"0001507\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0126640279437533},{\"序号\":76,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"覆层事业部\",\"明细编码\":\"0001508\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0138153032113672},{\"序号\":77,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"装配事业部\",\"明细编码\":\"0001509\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0322357074931902},{\"序号\":78,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"橡胶事业部\",\"明细编码\":\"0001510\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0276306064227344},{\"序号\":79,\"费用类别\":\"工资\",\"类别编码\":\"00016\",\"明细\":\"生产部\",\"明细编码\":\"0001511\",\"归属部门\":\"经营管理中心\",\"明细占部门预算比\":0.0310844322255763},{\"序号\":80,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"差旅费\",\"明细编码\":\"0000101\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.02518501},{\"序号\":81,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"招待费\",\"明细编码\":\"0000102\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00968654345383393},{\"序号\":82,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"通讯费\",\"明细编码\":\"0000103\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00484327172691696},{\"序号\":83,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"交通费\",\"明细编码\":\"0000104\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":3.87461738153358E-4},{\"序号\":84,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"劳保费\",\"明细编码\":\"0000106\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":5.81192607230037E-4},{\"序号\":85,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"办公费\",\"明细编码\":\"0000107\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.0968654345383393},{\"序号\":86,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"修理费\",\"明细编码\":\"0000108\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00193730869076679},{\"序号\":87,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"职工福利费\",\"明细编码\":\"0000109\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00581192607230037},{\"序号\":88,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"折旧费\",\"明细编码\":\"0000110\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":89,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"咨询服务费\",\"明细编码\":\"0000111\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00581192607230037},{\"序号\":90,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"物料消耗\",\"明细编码\":\"0000112\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":91,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"礼品费\",\"明细编码\":\"0000113\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00154984695261343},{\"序号\":92,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"会议费\",\"明细编码\":\"0000114\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":9.68654345383393E-4},{\"序号\":93,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"培训费\",\"明细编码\":\"0000116\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00193730869076679},{\"序号\":94,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"无形资产摊销\",\"明细编码\":\"0000117\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":95,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"其它\",\"明细编码\":\"0000118\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00871788910845054},{\"序号\":96,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"专项福利费\",\"明细编码\":\"0000119\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.0174357782169011},{\"序号\":97,\"费用类别\":\"管理费用\",\"类别编码\":\"00001\",\"明细\":\"领导费用\",\"明细编码\":\"0000120\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.027122321670735},{\"序号\":98,\"费用类别\":\"能耗费用\",\"类别编码\":\"00007\",\"明细\":\"生产电费\",\"明细编码\":\"0000701\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.125925064899841},{\"序号\":99,\"费用类别\":\"能耗费用\",\"类别编码\":\"00007\",\"明细\":\"生产水费\",\"明细编码\":\"0000702\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00251850129799683},{\"序号\":100,\"费用类别\":\"能耗费用\",\"类别编码\":\"00007\",\"明细\":\"办公电费\",\"明细编码\":\"0000703\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":101,\"费用类别\":\"能耗费用\",\"类别编码\":\"00007\",\"明细\":\"办公水费\",\"明细编码\":\"0000704\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":102,\"费用类别\":\"车辆费用\",\"类别编码\":\"00009\",\"明细\":\"油费\",\"明细编码\":\"0000901\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.027122321670735},{\"序号\":103,\"费用类别\":\"车辆费用\",\"类别编码\":\"00009\",\"明细\":\"年检费\",\"明细编码\":\"0000902\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":9.68654345383393E-4},{\"序号\":104,\"费用类别\":\"车辆费用\",\"类别编码\":\"00009\",\"明细\":\"保险费\",\"明细编码\":\"0000903\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00736177302491379},{\"序号\":105,\"费用类别\":\"车辆费用\",\"类别编码\":\"00009\",\"明细\":\"维修费\",\"明细编码\":\"0000904\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.00871788910845054},{\"序号\":106,\"费用类别\":\"车辆费用\",\"类别编码\":\"00009\",\"明细\":\"过路费\",\"明细编码\":\"0000905\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":5.81192607230037E-4},{\"序号\":107,\"费用类别\":\"车辆费用\",\"类别编码\":\"00009\",\"明细\":\"租赁费\",\"明细编码\":\"0000906\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":108,\"费用类别\":\"租金\",\"类别编码\":\"00010\",\"明细\":\"租金\",\"明细编码\":\"0001001\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.0639311867953039},{\"序号\":109,\"费用类别\":\"社保\",\"类别编码\":\"00011\",\"明细\":\"养老保险\",\"明细编码\":\"0001101\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.22279049943818},{\"序号\":110,\"费用类别\":\"社保\",\"类别编码\":\"00011\",\"明细\":\"工伤保险\",\"明细编码\":\"0001102\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.0154984695261343},{\"序号\":111,\"费用类别\":\"社保\",\"类别编码\":\"00011\",\"明细\":\"医疗保险\",\"明细编码\":\"0001103\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.0871788910845054},{\"序号\":112,\"费用类别\":\"社保\",\"类别编码\":\"00011\",\"明细\":\"失业保险\",\"明细编码\":\"0001104\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":113,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"房屋\",\"明细编码\":\"0001201\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":114,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"建筑物\",\"明细编码\":\"0001202\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":115,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"运输工具\",\"明细编码\":\"0001206\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":116,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"家具\",\"明细编码\":\"0001209\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0},{\"序号\":117,\"费用类别\":\"固定资产\",\"类别编码\":\"00012\",\"明细\":\"电子设备\",\"明细编码\":\"0001210\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.145298151807509},{\"序号\":118,\"费用类别\":\"工资\",\"类别编码\":\"00015\",\"明细\":\"行政管理中心\",\"明细编码\":\"0001501\",\"归属部门\":\"行政管理中心\",\"明细占部门预算比\":0.08330427}]";



        BizSubjectsExample bizSubjectsExample = new BizSubjectsExample();
        bizSubjectsExample.createCriteria();
        List<BizSubjects> bizSubjectsList = subjectsMapper.selectByExample(bizSubjectsExample);
        Map<String, BizSubjects> collect1 = bizSubjectsList.stream()
            .collect(Collectors.toMap(BizSubjects::getCode, Function.identity(), (c, b) -> c));

        Map<String, Integer> integerMap = departmentService.getDepartments().stream().collect(Collectors.toMap(DepartmentDTO::getDeptName, DepartmentDTO::getId));


        List<Map> parseArray = JSON.parseArray(str, Map.class);
        for (int i = 0; i < parseArray.size(); i++) {

            // 序号	费用类别	类别编码	明细	明细编码	归属部门	明细占部门预算比
            // INSERT INTO `haolifa`.`biz_cost_budget_subjects`
            // (`id`, `name`, `dept_id`, `subjects_type`, `subjects_id`, `cost_ratio`, `status`, `remark`, `del_flag`, `create_user`, `create_time`, `update_user`, `update_time`)
            // VALUES
            // (150, '差旅费', 24, '00003', 44, 0.012, '0', '', '0', NULL, NULL, NULL, NULL);
            Map map = parseArray.get(i);
            Object mx = map.get("明细编码");
            if (mx == null){
                continue;
            }
            BizSubjects bizSubjects = collect1.get(mx.toString());
            if (bizSubjects == null){
                continue;
            }
            BizCostBudgetSubjects costBudget = new BizCostBudgetSubjects();

            Double ys = new BigDecimal(map.get("明细占部门预算比").toString()).multiply(BigDecimal.valueOf(100)).setScale(3,BigDecimal.ROUND_HALF_UP).doubleValue();
            costBudget.setCostRatio(ys);
            costBudget.setSubjectsId(bizSubjects.getId());
            costBudget.setName(bizSubjects.getName());
            String dp = map.get("归属部门").toString();
            costBudget.setDeptId(integerMap.get(dp));
            costBudget.setSubjectsType(bizSubjects.getType());

            int insertId = bizCostBudgetSubjectsMapper.insertSelective(costBudget);
        }

    }


}
